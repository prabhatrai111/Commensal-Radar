clc; clear all; close all;

% load the data
% load data_all.mat

%% PCA and Scatterplot
% data_all = [2.83144000000000	2.78147000000000	2.50307200000000	2.86489000000000	2.94668100000000	2.94453400000000	2.79573000000000	2.82202400000000	2.72905500000000	2.87582900000000	2.80831800000000	2.73360800000000	2.61692100000000	2.90584000000000	2.65166300000000	2.62289100000000	2.84902700000000	2.82988900000000	2.75692500000000	2.87518900000000	2.63991100000000	2.59395000000000	2.72599600000000	2.61629000000000	2.71882200000000	3.03975400000000	2.76441400000000	2.97145400000000	2.49111800000000	3.02185900000000	2.72456600000000	2.79958900000000	2.33727900000000	2.80835400000000	2.47112300000000	2.82782900000000	2.35246800000000	2.96513000000000	2.41764300000000	2.97843400000000	2.18486300000000	2.84615300000000	2.42176800000000	3.00608100000000	2.30264100000000	2.96727500000000	2.36085500000000	2.79337300000000	2.33640300000000	2.91631800000000	2.58243800000000	2.73148800000000	2.54620400000000	2.86461600000000	2.35280300000000	2.97694900000000	2.41092900000000	2.86683100000000	2.43735600000000	2.92876300000000	2.66732300000000	3.01297200000000	2.30214300000000	2.92569400000000	2.44961200000000	2.92407500000000	2.37289000000000	2.78749200000000	2.19634800000000	2.99175800000000	2.18535100000000	2.90674400000000	2.12126400000000	3.11954000000000	2.30781100000000	2.87745600000000	2.12585900000000	2.82241600000000	2.23471300000000	2.86185600000000	2.24283200000000	2.82694000000000	2.35369100000000	2.95948600000000	2.13816200000000	2.90903700000000	2.16517900000000	3.08257400000000	2.24184800000000	2.88140800000000	2.49294300000000	2.84260300000000	2.57445500000000	3.02248200000000	2.82299300000000	2.78023200000000	2.80651300000000	2.43301300000000	2.99204000000000	2.55502700000000	2.83974600000000	2.42835400000000	2.78601900000000	2.74936000000000	2.24646800000000	2.87323200000000	2.66883500000000	3.10294700000000	2.41493000000000	3.21557700000000	2.52400200000000	2.67738100000000	2.66614500000000	2.99769600000000	2.30661700000000	2.61889100000000	2.09317100000000	3.08595200000000	2.23893200000000	3.14339800000000	2.40983900000000	2.69771000000000	2.75750800000000	2.23172200000000	3.08705100000000	2.34152800000000	2.43476800000000	2.99736900000000	2.17744300000000	3.30310200000000	3.13998400000000	2.36461200000000	3.09723500000000	2.73857200000000	2.35743100000000	2.08375600000000	3.49224900000000	2.50666100000000	2.17504600000000	2.75329300000000	2.76261300000000	2.61844200000000	2.07770900000000	2.50245300000000	1.97833800000000	3.45547900000000	2.09484600000000	3.42044000000000	1.48930600000000	3.23864700000000	2.78378700000000	2.87315300000000	2.59660200000000	2.00415300000000	2.29716000000000	2.52358000000000	2.68040500000000	2.87659200000000	3.14735400000000	2.86109800000000	2.95676600000000	3.84174000000000	3.89131900000000	2.97199300000000	3.24946000000000	3.70531100000000	3.19997800000000	2.89072700000000	2.43815400000000	3.00285700000000	2.41470200000000	2.71186800000000	2.08094500000000	2.73465600000000	2.24537700000000	2.26078900000000	2.48389200000000	2.25737300000000	1.81592400000000	1.46863900000000	1.66607900000000	2.04084000000000	1.86335000000000	1.63513300000000	1.28601900000000	0.985665000000000	0.953473000000000	0.901359000000000	0.571207000000000	0.512871000000000	0.546945000000000	2.11634300000000	2.88144700000000	3.34672400000000	3.60974100000000	4.11866000000000	4.62912100000000	5.58621400000000	5.41661600000000	5.28759400000000	5.05848100000000];
data_all = data_all';
[data_pca, lambda, mapping] = pca_eig_santu(data_all, 50);
data_pca = data_pca';
% select only top 30 principle components
data_pca_30 = abs(data_pca(:,1:30));
stem(data_pca_30)
